<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/register.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/alertregister.css') }}">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <title>Register</title>

</head>
<body>

    <div class="alert-messageRegister" style="display: none;">
        <div class="error-messagesRegister">
            <ul>
                {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <li class="{{ category }}">
                            {% if category == 'error' %}
                                <i class="bx bx-error-circle" style="color: red; margin-right: 5px;"></i>
                            {% endif %}
                            {{ message }}
                        </li>
                    {% endfor %}
                {% endif %}
                {% endwith %}
            </ul>            
            <button class="alert-ok-buttonRegister">OK</button>
        </div>
    </div>

    <div class="container">
        <h1>Register</h1>
        <form id="register-form" action="/register" method="POST">
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" required>
            </div>
            <button type="submit">Register</button>
        </form>
        <p>Already have an account? <a href="/login"><span style="color: #0aa45f; font-size: 14px; text-decoration: underline; margin-left: 10px;">Login here.</span></a></p>
    </div>

    <<script>
        document.addEventListener('DOMContentLoaded', function() {
            const alertMessages = document.querySelector('.alert-messageRegister');
            const alertOkButton = document.querySelector('.alert-ok-buttonRegister');
            const registerForm = document.getElementById('register-form');

            // Get the messages from the Flask session
            const messages = {{ get_flashed_messages() | tojson | safe }};
            
            if (Array.isArray(messages) && messages.length > 0) {
                alertMessages.style.display = 'flex'; // Show the alert if there are messages
            }

            // Hide alert and reset the form on clicking the OK button
            alertOkButton.addEventListener('click', function() {
                alertMessages.style.display = 'none'; // Hide the alert
                registerForm.reset(); // Reset the form fields
            });
        });
    </script>
    
</body>
</html>
